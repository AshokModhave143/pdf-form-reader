{% extends "base.html" %} {% block content %}
<div class="table-container">
  <h2>Mapped Data Preview: {{ pdf_file }}</h2>
  <div class="table-action-buttons">
    <form
      method="POST"
      action="{{ url_for('export_excel', filename=pdf_file) }}"
    >
      <input type="hidden" name="json_data" value="{{ json_data }}" />
      <button type="submit">Convert to Excel</button>
    </form>

    {% if excel_file %}
    <div class="download-excel-anchor">
      <a href="{{ url_for('process_download_excel', filename=excel_file) }}"
        >Download Excel</a
      >
    </div>
    {% endif %}
  </div>
  <table>
    <thead>
      <tr>
        <th>Label</th>
        <th>Custom Label</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      {% for field in form_data.values() %}
      <tr>
        <td>{{ field.label }}</td>
        <td>{{ field.customLabel }}</td>
        <td>{{ field.value }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
